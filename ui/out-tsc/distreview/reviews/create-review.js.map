{"version":3,"file":"create-review.js","sourceRoot":"","sources":["../../../src/distreview/reviews/create-review.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,KAAK,CAAC;AACvC,OAAO,EAAE,KAAK,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAEnE,OAAO,EAAE,eAAe,EAAE,MAAM,mBAAmB,CAAC;AACpD,OAAO,EAAE,mBAAmB,EAAE,cAAc,EAAE,MAAM,gBAAgB,CAAC;AAErE,OAAO,sBAAsB,CAAC;AAC9B,OAAO,wBAAwB,CAAC;AAChC,OAAO,yBAAyB,CAAC;AAG1B,IAAM,YAAY,GAAlB,MAAM,YAAa,SAAQ,UAAU;IAY1C,aAAa;QACX,OAAO,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;IAUD,KAAK,CAAC,YAAY;QAChB,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAgB,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,KAAK,YAAY,CAAE,CAAC;QAChG,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;QAC/B,OAAO,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QACtC,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;QAC5C,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC;QACnD,MAAM,WAAW,GAAsB;YACrC,GAAG,EAAE,IAAI,CAAC,GAAI;YACd,MAAM,EAAE;gBACN,MAAM,EAAE,IAAI,CAAC,OAAQ;aACtB;YACD,UAAU,EAAE,IAAI,CAAC,SAAU;SAC5B,CAAC;QAEF,MAAM,MAAM,GAAW,MAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC;YACtD,UAAU,EAAE,IAAI;YAChB,OAAO,EAAE,QAAQ,CAAC,OAAO;YACzB,SAAS,EAAE,SAAS;YACpB,OAAO,EAAE,eAAe;YACxB,OAAO,EAAE,WAAW;YACpB,UAAU,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;SAChC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,CAAC,IAAI,WAAW,CAAC,gBAAgB,EAAE;YACnD,QAAQ,EAAE,IAAI;YACd,OAAO,EAAE,IAAI;YACb,MAAM,EAAE;gBACN,UAAU,EAAE,MAAM,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI;aAC7C;SACF,CAAC,CAAC,CAAC;IACN,CAAC;IAED,MAAM;QACJ,OAAO,IAAI,CAAA;;;;8EAI+D,CAAC,CAAc,EAAE,EAAE,GAAG,IAAI,CAAC,OAAO,GAAI,CAAC,CAAC,MAAc,CAAC,KAAK,CAAC,CAAA,CAAE;;;;sBAIvH,CAAC,IAAI,CAAC,aAAa,EAAE;mBACxB,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE;;WAEjC,CAAC;IACV,CAAC;CACF,CAAA;AAnEC;IADC,KAAK,EAAE;6CAEG;AAGX;IADC,QAAQ,EAAE;+CACuB;AAGlC;IADC,QAAQ,EAAE;yCACa;AAOxB;IADC,eAAe,CAAC,EAAE,OAAO,EAAE,mBAAmB,EAAE,CAAC;kDACtB;AAG5B;IADC,eAAe,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC;6CAClB;AApBhB,YAAY;IADxB,aAAa,CAAC,eAAe,CAAC;GAClB,YAAY,CAsExB;SAtEY,YAAY","sourcesContent":["import { LitElement, html } from 'lit';\nimport { state, customElement, property } from 'lit/decorators.js';\nimport { InstalledCell, ActionHash, Record, AppWebsocket, InstalledAppInfo } from '@holochain/client';\nimport { contextProvided } from '@lit-labs/context';\nimport { appWebsocketContext, appInfoContext } from '../../contexts';\nimport { Review, CreateReviewInput } from './review';\nimport '@material/mwc-button';\nimport '@material/mwc-textarea';\nimport '@material/mwc-textfield';\n\n@customElement('create-review')\nexport class CreateReview extends LitElement {\n\n  @state()\n  _review: string\n | undefined;\n\n  @property()\n  paperHash: Uint8Array | undefined;\n\n  @property()\n  doi: string | undefined;\n\n  isReviewValid() {\n    return this._review;\n  }\n\n  @contextProvided({ context: appWebsocketContext })\n  appWebsocket!: AppWebsocket;\n\n  @contextProvided({ context: appInfoContext })\n  appInfo!: InstalledAppInfo;\n\n\n\n  async createReview() {\n    const cellData = this.appInfo.cell_data.find((c: InstalledCell) => c.role_id === 'distreview')!;\n    console.log(\"DOI: \", this.doi);\n    console.log(\"review: \", this._review);\n    console.log(\"paper hash: \", this.paperHash);\n    console.log(\"paper hash: \", typeof this.paperHash);\n    const reviewInput: CreateReviewInput = {\n      doi: this.doi!,\n      review: {\n        review: this._review!\n      },\n      paper_hash: this.paperHash!,\n    };\n\n    const record: Record = await this.appWebsocket.callZome({\n      cap_secret: null,\n      cell_id: cellData.cell_id,\n      zome_name: 'reviews',\n      fn_name: 'create_review',\n      payload: reviewInput,\n      provenance: cellData.cell_id[1]\n    });\n\n    this.dispatchEvent(new CustomEvent('review-created', {\n      composed: true,\n      bubbles: true,\n      detail: {\n        actionHash: record.signed_action.hashed.hash\n      }\n    }));\n  }\n\n  render() {\n    return html`\n      <div style=\"display: flex; flex-direction: column\">\n        <span style=\"font-size: 18px\">Create Review</span>\n\n          <mwc-textarea style=\"margin: 5px;\" outlined label=\"Review\" @input=${(e: CustomEvent) => { this._review = (e.target as any).value;} }></mwc-textarea>\n\n        <mwc-button\n          label=\"Create Review\"\n          .disabled=${!this.isReviewValid()}\n          @click=${() => this.createReview()}\n        ></mwc-button>\n    </div>`;\n  }\n}\n"]}