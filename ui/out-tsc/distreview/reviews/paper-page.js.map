{"version":3,"file":"paper-page.js","sourceRoot":"","sources":["../../../src/distreview/reviews/paper-page.ts"],"names":[],"mappings":";AAAA,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM,KAAK,CAAC;AAC5C,OAAO,EAAE,KAAK,EAAE,aAAa,EAAE,QAAQ,EAAE,MAAM,mBAAmB,CAAC;AAEnE,OAAO,EAAE,eAAe,EAAE,MAAM,mBAAmB,CAAC;AACpD,OAAO,EAAE,MAAM,EAAE,MAAM,kBAAkB,CAAC;AAC1C,OAAO,EAAE,cAAc,EAAE,mBAAmB,EAAE,MAAM,gBAAgB,CAAC;AAErE,OAAO,iCAAiC,CAAC;AACzC,OAAO,oBAAoB,CAAC;AAGrB,IAAM,SAAS,GAAf,MAAM,SAAU,SAAQ,UAAU;IAYvC,KAAK,CAAC,YAAY;QAChB,4BAA4B;QAC5B,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAgB,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,KAAK,YAAY,CAAE,CAAC;QAChG,MAAM,MAAM,GAAuB,MAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC;YAClE,UAAU,EAAE,IAAI;YAChB,OAAO,EAAE,QAAQ,CAAC,OAAO;YACzB,SAAS,EAAE,SAAS;YACpB,OAAO,EAAE,WAAW;YACpB,OAAO,EAAE,IAAI,CAAC,UAAU;YACxB,UAAU,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;SAChC,CAAC,CAAC;QACH,IAAI,MAAM,EAAE;YACV,IAAI,CAAC,MAAM,GAAG,MAAM,CAAE,MAAM,CAAC,KAAa,CAAC,OAAO,CAAC,KAAK,CAAU,CAAC;SACpE;IACH,CAAC;IAED,WAAW;QACT,IAAI,CAAC,aAAa,CAAC,IAAI,WAAW,CAAC,gBAAgB,EAAE;YACnD,QAAQ,EAAE,IAAI;YACd,OAAO,EAAE,IAAI;YACb,MAAM,EAAE,IAAI,CAAC,UAAU;SACxB,CAAC,CAAC,CAAC;IACN,CAAC;IAED,YAAY;QACV,IAAI,CAAC,aAAa,CAAC,IAAI,WAAW,CAAC,eAAe,EAAE;YAClD,QAAQ,EAAE,IAAI;YACd,OAAO,EAAE,IAAI;YACb,MAAM,EAAE;gBACN,KAAK,EAAE,IAAI,CAAC,MAAM;gBAClB,UAAU,EAAE,IAAI,CAAC,UAAU;aAC5B;SACF,CAAC,CAAC,CAAC;IACN,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChB,OAAO,IAAI,CAAA;;aAEJ,CAAC;SACT;QACD,OAAO,IAAI,CAAA;+DACgD,IAAI,CAAC,MAAM,CAAC,KAAM;qDAC5B,IAAI,CAAC,MAAM,CAAC,OAAQ;kDACvB,IAAI,CAAC,MAAM,CAAC,GAAI;yBACzC,IAAI,CAAC,YAAY;;wCAEF,IAAI,CAAC,UAAU;KAClD,CAAC;IACJ,CAAC;;AAEM,gBAAM,GAAG,GAAG,CAAA;;;;;;GAMlB,CAAA;AAnED;IADC,QAAQ,EAAE;6CACa;AAGxB;IADC,KAAK,EAAE;yCACkB;AAG1B;IADC,eAAe,CAAC,EAAE,OAAO,EAAE,mBAAmB,EAAE,CAAC;+CACtB;AAE5B;IADC,eAAe,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,CAAC;0CAClB;AAVhB,SAAS;IADrB,aAAa,CAAC,YAAY,CAAC;GACf,SAAS,CAsErB;SAtEY,SAAS","sourcesContent":["import { LitElement, html, css } from 'lit';\nimport { state, customElement, property } from 'lit/decorators.js';\nimport { InstalledCell, AppWebsocket, Record, ActionHash, InstalledAppInfo } from '@holochain/client';\nimport { contextProvided } from '@lit-labs/context';\nimport { decode } from '@msgpack/msgpack';\nimport { appInfoContext, appWebsocketContext } from '../../contexts';\nimport { Paper } from './paper';\nimport '@material/mwc-circular-progress';\nimport './review-for-paper';\n\n@customElement('paper-page')\nexport class PaperPage extends LitElement {\n  @property()\n  actionHash!: ActionHash;\n\n  @state()\n  _paper: Paper | undefined;\n\n  @contextProvided({ context: appWebsocketContext })\n  appWebsocket!: AppWebsocket;\n  @contextProvided({ context: appInfoContext })\n  appInfo!: InstalledAppInfo;\n\n  async firstUpdated() {\n    // get all reviews for paper\n    const cellData = this.appInfo.cell_data.find((c: InstalledCell) => c.role_id === 'distreview')!;\n    const record: Record | undefined = await this.appWebsocket.callZome({\n      cap_secret: null,\n      cell_id: cellData.cell_id,\n      zome_name: 'reviews',\n      fn_name: 'get_paper',\n      payload: this.actionHash,\n      provenance: cellData.cell_id[1]\n    });\n    if (record) {\n      this._paper = decode((record.entry as any).Present.entry) as Paper;\n    }\n  }\n\n  selectPaper() {\n    this.dispatchEvent(new CustomEvent('paper-selected', {\n      composed: true,\n      bubbles: true,\n      detail: this.actionHash\n    }));\n  }\n\n  createReview() {\n    this.dispatchEvent(new CustomEvent('create-review', {\n      composed: true,\n      bubbles: true,\n      detail: {\n        paper: this._paper,\n        actionHash: this.actionHash,\n      }\n    }));\n  }\n\n  render() {\n    if (!this._paper) {\n      return html`<div style=\"display: flex; flex: 1; align-items: center; justify-content: center\">\n        <mwc-circular-progress indeterminate></mwc-circular-progress>\n      </div>`;\n    }\n    return html`\n      <div class=\"paper-title\" style=\"white-space: pre-line\">${this._paper.title }</div>\n        <div style=\"white-space: pre-line\">author: ${this._paper.authors }</div>\n        <div style=\"white-space: pre-line\">doi: ${this._paper.doi }</div>\n        <button @click=${this.createReview}>Create Review</button>\n      <!-- add reviews -->\n        <review-for-paper .actionHash=${this.actionHash}></review-for-paper>\n    `;\n  }\n\n  static styles = css`\n    .paper-title {\n      font-size: 1.2em;\n      color: #183E29;\n      font-family: 'Space Mono';\n    }\n  `\n}\n"]}